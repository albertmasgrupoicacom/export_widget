{"version":3,"sources":["private.js"],"names":["originalObject","Object","originalDefProp","defineProperty","originalCreate","create","defProp","obj","name","value","call","definePropertyIsBrokenInIE8","makeSafeToCall","fun","apply","hasOwn","prototype","hasOwnProperty","numToStr","Number","toString","strSlice","String","slice","cloner","rand","Math","random","uniqueKeys","makeUniqueKey","uniqueKey","internString","str","keys","exports","originalGetOPNs","getOwnPropertyNames","object","names","src","dst","len","length","defaultCreatorFn","makeAccessor","secretCreatorFn","brand","passkey","register","secret","vault","key","forget","accessor"],"mappings":"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","file":"private.js","sourcesContent":["\"use strict\";\n\nvar originalObject = Object;\nvar originalDefProp = Object.defineProperty;\nvar originalCreate = Object.create;\n\nfunction defProp(obj, name, value) {\n  if (originalDefProp) try {\n    originalDefProp.call(originalObject, obj, name, { value: value });\n  } catch (definePropertyIsBrokenInIE8) {\n    obj[name] = value;\n  } else {\n    obj[name] = value;\n  }\n}\n\n// For functions that will be invoked using .call or .apply, we need to\n// define those methods on the function objects themselves, rather than\n// inheriting them from Function.prototype, so that a malicious or clumsy\n// third party cannot interfere with the functionality of this module by\n// redefining Function.prototype.call or .apply.\nfunction makeSafeToCall(fun) {\n  if (fun) {\n    defProp(fun, \"call\", fun.call);\n    defProp(fun, \"apply\", fun.apply);\n  }\n  return fun;\n}\n\nmakeSafeToCall(originalDefProp);\nmakeSafeToCall(originalCreate);\n\nvar hasOwn = makeSafeToCall(Object.prototype.hasOwnProperty);\nvar numToStr = makeSafeToCall(Number.prototype.toString);\nvar strSlice = makeSafeToCall(String.prototype.slice);\n\nvar cloner = function(){};\nfunction create(prototype) {\n  if (originalCreate) {\n    return originalCreate.call(originalObject, prototype);\n  }\n  cloner.prototype = prototype || null;\n  return new cloner;\n}\n\nvar rand = Math.random;\nvar uniqueKeys = create(null);\n\nfunction makeUniqueKey() {\n  // Collisions are highly unlikely, but this module is in the business of\n  // making guarantees rather than safe bets.\n  do var uniqueKey = internString(strSlice.call(numToStr.call(rand(), 36), 2));\n  while (hasOwn.call(uniqueKeys, uniqueKey));\n  return uniqueKeys[uniqueKey] = uniqueKey;\n}\n\nfunction internString(str) {\n  var obj = {};\n  obj[str] = true;\n  return Object.keys(obj)[0];\n}\n\n// External users might find this function useful, but it is not necessary\n// for the typical use of this module.\nexports.makeUniqueKey = makeUniqueKey;\n\n// Object.getOwnPropertyNames is the only way to enumerate non-enumerable\n// properties, so if we wrap it to ignore our secret keys, there should be\n// no way (except guessing) to access those properties.\nvar originalGetOPNs = Object.getOwnPropertyNames;\nObject.getOwnPropertyNames = function getOwnPropertyNames(object) {\n  for (var names = originalGetOPNs(object),\n           src = 0,\n           dst = 0,\n           len = names.length;\n       src < len;\n       ++src) {\n    if (!hasOwn.call(uniqueKeys, names[src])) {\n      if (src > dst) {\n        names[dst] = names[src];\n      }\n      ++dst;\n    }\n  }\n  names.length = dst;\n  return names;\n};\n\nfunction defaultCreatorFn(object) {\n  return create(null);\n}\n\nfunction makeAccessor(secretCreatorFn) {\n  var brand = makeUniqueKey();\n  var passkey = create(null);\n\n  secretCreatorFn = secretCreatorFn || defaultCreatorFn;\n\n  function register(object) {\n    var secret; // Created lazily.\n\n    function vault(key, forget) {\n      // Only code that has access to the passkey can retrieve (or forget)\n      // the secret object.\n      if (key === passkey) {\n        return forget\n          ? secret = null\n          : secret || (secret = secretCreatorFn(object));\n      }\n    }\n\n    defProp(object, brand, vault);\n  }\n\n  function accessor(object) {\n    if (!hasOwn.call(object, brand))\n      register(object);\n    return object[brand](passkey);\n  }\n\n  accessor.forget = function(object) {\n    if (hasOwn.call(object, brand))\n      object[brand](passkey, true);\n  };\n\n  return accessor;\n}\n\nexports.makeAccessor = makeAccessor;\n"]}