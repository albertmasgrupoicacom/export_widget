{"version":3,"sources":["_task.js"],"names":["ctx","require","invoke","html","cel","global","process","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","Dispatch","counter","queue","ONREADYSTATECHANGE","defer","channel","port","run","id","hasOwnProperty","fn","listener","event","call","data","args","i","arguments","length","push","Function","nextTick","now","port2","port1","onmessage","postMessage","addEventListener","importScripts","appendChild","removeChild","setTimeout","module","exports","set","clear"],"mappings":"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","file":"_task.js","sourcesContent":["var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n"]}