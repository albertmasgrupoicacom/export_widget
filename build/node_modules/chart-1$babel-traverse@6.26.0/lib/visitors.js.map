{"version":3,"sources":["visitors.js"],"names":["exports","__esModule","_typeof2","require","_typeof3","_interopRequireDefault","_keys","_keys2","_getIterator2","_getIterator3","explode","verify","merge","_virtualTypes","virtualTypes","_interopRequireWildcard","_babelMessages","messages","_babelTypes","t","_clone","_clone2","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","visitor","_exploded","nodeType","shouldIgnoreKey","parts","split","length","fns","_iterator","_isArray","Array","isArray","_i","_ref","next","done","value","part","ensureEntranceObjects","ensureCallbackArrays","_iterator2","_isArray2","_i2","_ref2","_nodeType3","wrapper","_fns2","type","wrapCheck","types","_iterator4","_isArray4","_i4","_ref4","_type","mergePair","_nodeType","_fns","aliases","FLIPPED_ALIAS_KEYS","deprecratedKey","DEPRECATED_KEYS","console","trace","_iterator3","_isArray3","_i3","_ref3","alias","existing","_nodeType2","_verified","Error","get","validateVisitorMethods","TYPES","indexOf","visitors","visitorKey","path","val","concat","_iterator5","_isArray5","_i5","_ref5","fn","TypeError","states","arguments","undefined","rootVisitor","i","state","visitorType","wrapWithStateOrWrapper","nodeVisitor","oldVisitor","newVisitor","_loop","map","newFn","_ret","enter","exit","checkPath","apply","toString","dest","src"],"mappings":"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","file":"visitors.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"babel-runtime/helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _keys = require(\"babel-runtime/core-js/object/keys\");\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nexports.explode = explode;\nexports.verify = verify;\nexports.merge = merge;\n\nvar _virtualTypes = require(\"./path/lib/virtual-types\");\n\nvar virtualTypes = _interopRequireWildcard(_virtualTypes);\n\nvar _babelMessages = require(\"babel-messages\");\n\nvar messages = _interopRequireWildcard(_babelMessages);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nvar _clone = require(\"lodash/clone\");\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction explode(visitor) {\n  if (visitor._exploded) return visitor;\n  visitor._exploded = true;\n\n  for (var nodeType in visitor) {\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    var parts = nodeType.split(\"|\");\n    if (parts.length === 1) continue;\n\n    var fns = visitor[nodeType];\n    delete visitor[nodeType];\n\n    for (var _iterator = parts, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var part = _ref;\n\n      visitor[part] = fns;\n    }\n  }\n\n  verify(visitor);\n\n  delete visitor.__esModule;\n\n  ensureEntranceObjects(visitor);\n\n  ensureCallbackArrays(visitor);\n\n  for (var _iterator2 = (0, _keys2.default)(visitor), _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : (0, _getIterator3.default)(_iterator2);;) {\n    var _ref2;\n\n    if (_isArray2) {\n      if (_i2 >= _iterator2.length) break;\n      _ref2 = _iterator2[_i2++];\n    } else {\n      _i2 = _iterator2.next();\n      if (_i2.done) break;\n      _ref2 = _i2.value;\n    }\n\n    var _nodeType3 = _ref2;\n\n    if (shouldIgnoreKey(_nodeType3)) continue;\n\n    var wrapper = virtualTypes[_nodeType3];\n    if (!wrapper) continue;\n\n    var _fns2 = visitor[_nodeType3];\n    for (var type in _fns2) {\n      _fns2[type] = wrapCheck(wrapper, _fns2[type]);\n    }\n\n    delete visitor[_nodeType3];\n\n    if (wrapper.types) {\n      for (var _iterator4 = wrapper.types, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : (0, _getIterator3.default)(_iterator4);;) {\n        var _ref4;\n\n        if (_isArray4) {\n          if (_i4 >= _iterator4.length) break;\n          _ref4 = _iterator4[_i4++];\n        } else {\n          _i4 = _iterator4.next();\n          if (_i4.done) break;\n          _ref4 = _i4.value;\n        }\n\n        var _type = _ref4;\n\n        if (visitor[_type]) {\n          mergePair(visitor[_type], _fns2);\n        } else {\n          visitor[_type] = _fns2;\n        }\n      }\n    } else {\n      mergePair(visitor, _fns2);\n    }\n  }\n\n  for (var _nodeType in visitor) {\n    if (shouldIgnoreKey(_nodeType)) continue;\n\n    var _fns = visitor[_nodeType];\n\n    var aliases = t.FLIPPED_ALIAS_KEYS[_nodeType];\n\n    var deprecratedKey = t.DEPRECATED_KEYS[_nodeType];\n    if (deprecratedKey) {\n      console.trace(\"Visitor defined for \" + _nodeType + \" but it has been renamed to \" + deprecratedKey);\n      aliases = [deprecratedKey];\n    }\n\n    if (!aliases) continue;\n\n    delete visitor[_nodeType];\n\n    for (var _iterator3 = aliases, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : (0, _getIterator3.default)(_iterator3);;) {\n      var _ref3;\n\n      if (_isArray3) {\n        if (_i3 >= _iterator3.length) break;\n        _ref3 = _iterator3[_i3++];\n      } else {\n        _i3 = _iterator3.next();\n        if (_i3.done) break;\n        _ref3 = _i3.value;\n      }\n\n      var alias = _ref3;\n\n      var existing = visitor[alias];\n      if (existing) {\n        mergePair(existing, _fns);\n      } else {\n        visitor[alias] = (0, _clone2.default)(_fns);\n      }\n    }\n  }\n\n  for (var _nodeType2 in visitor) {\n    if (shouldIgnoreKey(_nodeType2)) continue;\n\n    ensureCallbackArrays(visitor[_nodeType2]);\n  }\n\n  return visitor;\n}\n\nfunction verify(visitor) {\n  if (visitor._verified) return;\n\n  if (typeof visitor === \"function\") {\n    throw new Error(messages.get(\"traverseVerifyRootFunction\"));\n  }\n\n  for (var nodeType in visitor) {\n    if (nodeType === \"enter\" || nodeType === \"exit\") {\n      validateVisitorMethods(nodeType, visitor[nodeType]);\n    }\n\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    if (t.TYPES.indexOf(nodeType) < 0) {\n      throw new Error(messages.get(\"traverseVerifyNodeType\", nodeType));\n    }\n\n    var visitors = visitor[nodeType];\n    if ((typeof visitors === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(visitors)) === \"object\") {\n      for (var visitorKey in visitors) {\n        if (visitorKey === \"enter\" || visitorKey === \"exit\") {\n          validateVisitorMethods(nodeType + \".\" + visitorKey, visitors[visitorKey]);\n        } else {\n          throw new Error(messages.get(\"traverseVerifyVisitorProperty\", nodeType, visitorKey));\n        }\n      }\n    }\n  }\n\n  visitor._verified = true;\n}\n\nfunction validateVisitorMethods(path, val) {\n  var fns = [].concat(val);\n  for (var _iterator5 = fns, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : (0, _getIterator3.default)(_iterator5);;) {\n    var _ref5;\n\n    if (_isArray5) {\n      if (_i5 >= _iterator5.length) break;\n      _ref5 = _iterator5[_i5++];\n    } else {\n      _i5 = _iterator5.next();\n      if (_i5.done) break;\n      _ref5 = _i5.value;\n    }\n\n    var fn = _ref5;\n\n    if (typeof fn !== \"function\") {\n      throw new TypeError(\"Non-function found defined in \" + path + \" with type \" + (typeof fn === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(fn)));\n    }\n  }\n}\n\nfunction merge(visitors) {\n  var states = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var wrapper = arguments[2];\n\n  var rootVisitor = {};\n\n  for (var i = 0; i < visitors.length; i++) {\n    var visitor = visitors[i];\n    var state = states[i];\n\n    explode(visitor);\n\n    for (var type in visitor) {\n      var visitorType = visitor[type];\n\n      if (state || wrapper) {\n        visitorType = wrapWithStateOrWrapper(visitorType, state, wrapper);\n      }\n\n      var nodeVisitor = rootVisitor[type] = rootVisitor[type] || {};\n      mergePair(nodeVisitor, visitorType);\n    }\n  }\n\n  return rootVisitor;\n}\n\nfunction wrapWithStateOrWrapper(oldVisitor, state, wrapper) {\n  var newVisitor = {};\n\n  var _loop = function _loop(key) {\n    var fns = oldVisitor[key];\n\n    if (!Array.isArray(fns)) return \"continue\";\n\n    fns = fns.map(function (fn) {\n      var newFn = fn;\n\n      if (state) {\n        newFn = function newFn(path) {\n          return fn.call(state, path, state);\n        };\n      }\n\n      if (wrapper) {\n        newFn = wrapper(state.key, key, newFn);\n      }\n\n      return newFn;\n    });\n\n    newVisitor[key] = fns;\n  };\n\n  for (var key in oldVisitor) {\n    var _ret = _loop(key);\n\n    if (_ret === \"continue\") continue;\n  }\n\n  return newVisitor;\n}\n\nfunction ensureEntranceObjects(obj) {\n  for (var key in obj) {\n    if (shouldIgnoreKey(key)) continue;\n\n    var fns = obj[key];\n    if (typeof fns === \"function\") {\n      obj[key] = { enter: fns };\n    }\n  }\n}\n\nfunction ensureCallbackArrays(obj) {\n  if (obj.enter && !Array.isArray(obj.enter)) obj.enter = [obj.enter];\n  if (obj.exit && !Array.isArray(obj.exit)) obj.exit = [obj.exit];\n}\n\nfunction wrapCheck(wrapper, fn) {\n  var newFn = function newFn(path) {\n    if (wrapper.checkPath(path)) {\n      return fn.apply(this, arguments);\n    }\n  };\n  newFn.toString = function () {\n    return fn.toString();\n  };\n  return newFn;\n}\n\nfunction shouldIgnoreKey(key) {\n  if (key[0] === \"_\") return true;\n\n  if (key === \"enter\" || key === \"exit\" || key === \"shouldSkip\") return true;\n\n  if (key === \"blacklist\" || key === \"noScope\" || key === \"skipKeys\") return true;\n\n  return false;\n}\n\nfunction mergePair(dest, src) {\n  for (var key in src) {\n    dest[key] = [].concat(dest[key] || [], src[key]);\n  }\n}"]}